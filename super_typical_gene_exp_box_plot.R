#!/home/miniconda3/envs/software/bin/Rscript
Args <- commandArgs()
boxdata_super=read.table(Args[6],header=F,quote='\t',row.names = 1)
boxdata_super_average<-as.data.frame(rowMeans(boxdata_super))
group_super<-as.data.frame(c(rep("super",length(c(boxdata_super[,1])))))
boxdata_super<-cbind(boxdata_super_average,group_super)
colnames(boxdata_super)<-c("exp","group")
boxdata_typical=read.table(Args[7],header=F,quote='\t',row.names = 1)
boxdata_typical_average<-as.data.frame(rowMeans(boxdata_typical))
group_typical<-as.data.frame(c(rep("typical",length(c(boxdata_typical[,1])))))
boxdata_typical<-cbind(boxdata_typical_average,group_typical)
colnames(boxdata_typical)<-c("exp","group")
boxdata<-rbind(boxdata_super,boxdata_typical)
library(nortest)
a<-c(boxdata$exp[which(boxdata$group=="super")])
b<-c(boxdata$exp[which(boxdata$group=="typical")])
test<-wilcox.test(a,b,alternative="greater",paired = F)
p<-test$p.value
tiff(Args[8],width = 1500,height = 1500,res=300)
boxplot(exp~group,data=boxdata,outline =F,col=c("#9400D3","grey"),boxwex=0.2,par(las="2"),bty="l",xlab = NA,ylab = "Gene expression",cex.axis=1,cex.lab=1.2,at=c(2,1),main=paste("PValue:", signif(p,4)),cex.main=1)
dev.off()
